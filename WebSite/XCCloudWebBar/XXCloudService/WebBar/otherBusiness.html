<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>吧台</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 引入样式 -->
    <link rel="stylesheet" type="text/css" href="http://unpkg.com/iview/dist/styles/iview.css">
    <script type="text/javascript" src="http://vuejs.org/js/vue.min.js"></script>
    <script type="text/javascript" src="http://unpkg.com/iview/dist/iview.min.js"></script>
    <link rel='icon' href='xinchen.ico ' type='image/x-ico'/>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/iconfont.css">
    <link href="css/style.css" rel="stylesheet">
 
    <style>
        /*新style*/
        .menu-style{margin-top: 1em;line-height: 2em;font-size: 1.1em;}
        .menu-radio{margin:0 0.5em;}
        .menu-radio input{height: 1.2em;width: 1.2em;}
        .margin1{margin-top: 1em;}
        .menu-btn{display: flex; flex-direction: row;justify-content: space-between;margin-top: 2em;padding: 0 2em;}
        .menu-btn button{width: 36%;}
        .menu-r-btn{text-align: right;padding-right: 3em;margin-bottom: 1em;margin-top: 2em;} */
        .margin-02 input{margin-top: -0.3em}
        .width50 button{width: 50%}
        .order-style{margin-top: 0.5em;line-height: 1.6em;font-size: 1em;padding-left: 10px!important;padding-right: 10px!important;}
        .heightOver{overflow-y: auto;overflow-x: hidden;height: 500px;padding: 0;}
        .order-btn{display: flex; flex-direction: row;justify-content: space-between;margin-top: 2em;padding: 0 1em;}
        .menu-btn button{width: 30%;margin: 0 1em;}
        .input-group[class*=col-]{float: left;}
        .table{font-size: 1em;}
        .input-group-addon{border: none;}
        .cardLoss{ border-top:1px solid #fefefe; border-bottom:1px solid #fefefe;font-size: 1.8em;height: 2.4em;line-height: 2.4em;color: #fefefe;margin-top: 1em;}
        .sendMessage{line-height: 0!important;}
        .onSwitch{background-color: #349ffd;border-radius: 5px;text-align: center;}
        .switchZdy {border-radius: 4px;background-color: #FFFFFF;padding:0;font-size: 1em;}
        .pad_10{padding-right: 5px;}
        .cardLoss-btn{margin-top: 2.5em;}
        .cardLoss-btn button{width: 100%;}
        /*谷歌滚动条样式修改*/
        .scrollbar{  width: 5px;  height: 100px;  margin: 0 auto;  }
        ::-webkit-scrollbar {/*滚动条整体样式*/  width: 5px;  /*高宽分别对应横竖滚动条的尺寸*/  height: 1px;}
        ::-webkit-scrollbar-thumb {/*滚动条里面小方块*/ border-radius: 10px; -webkit-box-shadow: inset 0 0 5px rgba(0,0,0,0.2); background: #535353;}
        ::-webkit-scrollbar-track {/*滚动条里面轨道*/-webkit-box-shadow: inset 0 0 5px rgba(0,0,0,0.2);border-radius: 10px;background: #EDEDED;}
        .otherAddon{width: 7em;}
        .padding_right{padding-right:0!important;}
        .padding_left{padding-left:0!important;}
        .dropChoosesty li{padding: 0 15px;font-size: 1.3em;line-height: 2.5em;}
        .dropChoosesty li span{margin-right: 8px;position: relative;top: 4px;}
        .dropChoosesty li:nth-child(1) span{color: #349ffd;font-size:2em;}
        .dropChoosesty li:nth-child(2) span{color: #00ffff;font-size:1.4em;}
        .dropChoosesty li:nth-child(3) span{color: #5b6270;font-size:1.1em;}
        .cardChoosesty li{padding: 0 15px;line-height: 2.5em;}
        .cardChoosesty li em{font-size: 1em;color:#666;line-height: 2.5em;}
        .cardChoosesty li span{margin-right: 8px;position: relative;top: 2px;}
        .cardChoosesty li:nth-child(1) span{color: #349ffd;font-size:1.5em;}
        .cardChoosesty li:nth-child(2) span{color: #00ffff;font-size:1.1em;}
        .readCard:hover{background-color: #b196fd;color: #fefefe;}
        .vertical-center-modal{display: flex;align-items: center;justify-content: center;margin-top:-20%;}
        .dropdown-grounp{display: flex;flex-direction: row;}
        .dropdownSty{min-width: 70px;margin-left: 1em;}
        .dropdownInput{top:10px;}
        .form-control{padding: 4px 7px;height: 32px;}
        .input-group-addon {padding: 4px 7px;}
        .btn{padding: 4px 7px;}
        .transferDatadropup{display: flex;margin-top: 1.2em;}
    </style>
</head>
<body>
<div id="app" v-cloak>
    <!--header-->
    <div class="container-fluid boxShadow">
        <!--导航-->
        <div class="navbar-collapse collapse">
            <div class="navbar-header">
                <a href="index.html" class="navbar-brand"><img src="images/logo.png"></a>
            </div>
            <ul class="nav navbar-nav navbar-right">
                <li><a class="boxBtn" href="javascript:void(0);"><span class="glyphicon glyphicon-menu-down"></span>&nbsp;&nbsp;现金:￥10500</a></li>
                <li class="active"><a href="index.html"><span class="glyphicon glyphicon-home"></span>&nbsp;&nbsp;莘宸乐园【同城广场店】</a></li>
                <li><a href="#"><span class="glyphicon glyphicon-user mag-_r1"></span><i>当前操作员：</i>&nbsp;&nbsp;张三</a></li>
                <li class="dropdown">
                    <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        未读消息 (0)
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="index.html">1</a></li>
                        <li><a href="index.html">1</a></li>
                        <li><a href="index.html">1</a></li>
                        <li><a href="index.html">1</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        admin
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="dLabel">
                        <li><a href="index.html"><span class="glyphicon glyphicon-screenshot"></span>&nbsp;&nbsp;前台首页</a></li>
                        <li><a href="index.html"><span class="glyphicon glyphicon-user"></span>&nbsp;&nbsp;个人主页</a></li>
                        <li><a href="index.html"><span class="glyphicon glyphicon-cog"></span>&nbsp;&nbsp;个人设置</a></li>
                        <li><a href="index.html"><span class="glyphicon glyphicon-credit-card"></span>&nbsp;&nbsp;账户中心</a></li>
                        <li><a href="index.html"><span class="glyphicon glyphicon-heart"></span>&nbsp;&nbsp;我的收藏</a></li>
                    </ul>
                </li>
                <li><a href="#"><span class="glyphicon glyphicon-off"></span>&nbsp;&nbsp;退出</a></li>
                <div class="bbs text-right">
                    <p>开班时间：2017-08-23 15:38:12 <span>当前时间： <em id="oDiv"></em></span></p>
                </div>
            </ul>
            <div class="navbar-right navLeftS">
                <!--<div class="col-md-6 col-sm-6 navStyle">-->
                <div class="navStyle">
                    <h4>售币机</h4>
                    <p>18000/30000</p>
                </div>
                <div class="navT">60%</div>
            </div>
        </div>
        <!--导航-->
    </div>
    <!--查询获取卡列表-->
    <modal v-model="cardListModel" title="温馨提示！" width="900">
        <row v-if="cardListModel">
            <i-col span="12">
                <i-input v-model="inquireCard.mobileCode">
                    <span slot="prepend" style="width: 160px">验证码：</span>
                    <i-button slot="append" type="button" class="readCard" @click="sendCode('1')" :disabled="inquireCard.disabled">{{inquireCard.codeBtn}}</i-button>
                </i-input>
            </i-col>
            <i-col span="12">
                <i-button type="button" class="readCard" @click="getMember('2')">按手机号查询</i-button>
            </i-col>
        </row>
        <row v-if="cardListModel">
            <i-col span="24">
                <table class="table table-bordered">
                    <tr v-for="(item,index) in cardList" @click="radioCard(index)">
                        <td><input type="radio" name="optionsRadios" :value="index" v-model="radioValue"></td>
                        <td>
                            <h4>会员卡号</h4>
                            <p>{{item.ICCardNo}}</p>
                        </td>
                        <td>
                            <h4>到期日期</h4>
                            <p>{{item.EndDate}}</p>
                        </td>
                        <td>
                            <h4>会员等级</h4>
                            <p>{{item.LevelName}}</p>
                        </td>
                    </tr>
                </table>
            </i-col>
        </row>
        <div slot="footer"> 
        </div>
    </modal>
    <!-- Modal(确认) -->
    <modal v-model="modalDelete" title="Common Modal dialog box title" class-name="vertical-center-modal" @on-ok="okClearUp">
        <p>确认删除</p>
    </modal>
    <!-- Modal(通用提示框) -->
    <modal v-model="myModal" title="温馨提示！" class-name="vertical-center-modal">
        <p>{{ msg }}</p>
        <div slot="footer"> </div>
    </modal>
    <i-menu mode="horizontal" theme="light" active-name="1" @on-select="chooseMenu">
            <menu-item name="1">
                <span class="iconfont icon-batai"></span>
                收银台
            </menu-item>
            <menu-item name="2">
                <span class="iconfont icon-jingdianmenpiao"></span>
                终端扣门票
            </menu-item>
            <menu-item name="3">
                <span class="iconfont icon-peitongruxue"></span>
                陪同票
            </menu-item>
            <menu-item name="4">
                <span class="iconfont icon-jishi"></span>
                计时票补、退款
            </menu-item>
            <menu-item name="5">
                <span class="iconfont icon-qinglikehu"></span>
                手工清场
            </menu-item>
            <menu-item name="6">
                <span class="iconfont icon-dingdanchaxun1"></span>
                订单查询
            </menu-item>
            <menu-item name="7">
                <span class="iconfont icon-lipinhuigou"></span>
                礼品回购
            </menu-item>
            <menu-item name="8">
                <span class="iconfont icon-icon"></span>
                会员过户操作
            </menu-item>
            <menu-item name="9">
                <span class="iconfont icon-jiaobanguanli"></span>
                交班总结
            </menu-item>
            <menu-item name="10">
                <span class="iconfont icon-jiabi"></span>
                    吧台加币
            </menu-item>
        </i-menu>
        <row>
            <i-col span="24" v-if="minuData.MenuShow1">
                    <div class="col-md-4 col-sm-4 menu-style">
                            <div class="input-group col-lg-12 col-md-12 menu-style">
                                <span class="input-group-addon">扣费项目：</span>
                                <input type="text" class="form-control" placeholder="扣费项目"/>
                            </div>
                            <div class="input-group col-lg-12 col-md-12 menu-style">
                                <span class="input-group-addon">会员卡号：</span>
                                <input type="text" class="form-control" placeholder="门票票码"/>
                                <div class="input-group-btn">
                                    <button type="button" class="btn btn-default">读卡</button>
                                </div>
                            </div>
                            <div class="input-group col-lg-12 col-md-12 menu-style">
                                <span class="input-group-addon">门票票码：</span>
                                <input type="text" class="form-control" placeholder="门票票码"/>
                            </div>
                    </div>
                        <div class="col-md-3 col-sm-3 menu-style">
                            <div class="radio col-md-12 col-sm-12 menu-style">
                                <label class="menu-radio">
                                    <input type="radio" name="optionsRadios" value="option1" checked>
                                    入闸
                                </label>
                                <label class="menu-radio">
                                    <input type="radio" name="optionsRadios" value="option2">
                                    出闸
                                </label>
                            </div>
                            <div class="input-group col-lg-12 col-md-12 menu-style">
                                <span class="input-group-addon">验票次数：</span>
                                <input type="text" class="form-control" placeholder="次数"/>
                            </div>

                        </div>
                        <div class="col-md-5 col-sm-5 menu-style">
                            <label class="col-sm-12 control-label menu-style">使用说明</label>
                            <div class="col-sm-12 menu-style">
                                <textarea class="form-control" rows="3"></textarea>
                            </div>
                        </div>
                    
                    <div class="col-md-12 col-sm-12 margin1">
                        <table class="table table-bordered">
                            <thead style="background: #f5f5f5">
                            <tr>
                                <th>门票</th>
                                <th>类型</th>
                                <th>购买时间</th>
                                <th>过期时间</th>
                                <th> 总次数</th>
                                <th>已使用</th>
                                <th>剩余次数</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="items in refundData">
                                <td>{{items.balanceType}}</td>
                                <td>{{items.balance}}</td>
                                <td>{{items.balance1}}</td>
                                <td>{{items.balance2}}</td>
                                <td>{{items.balance3}}</td>
                                <td>{{items.balance4}}</td>
                                <td>{{items.balance5}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    
            </i-col>
            <i-col span="24" v-if="minuData.MenuShow2">
                <div class="col-md-5 col-sm-5 menu-style">
                    <div class="input-group">
                        <span class="input-group-addon">会员卡号：</span>
                        <input type="text" class="form-control" placeholder="门票票码"/>
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-default">读卡</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-7 col-sm-7 menu-style">
                    <div class="input-group">
                        <span class="input-group-addon">门票票码：</span>
                        <input type="text" class="form-control" placeholder="门票票码"/>
                    </div>
                </div>
                <div class="col-md-12 col-sm-12 margin1">
                    <table class="table table-bordered">
                        <thead style="background: #f5f5f5">
                        <tr>
                            <th></th>
                            <th>门票</th>
                            <th>类型</th>
                            <th>购买时间</th>
                            <th>过期时间</th>
                            <th> 总次数</th>
                            <th>已使用</th>
                            <th>剩余次数</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr v-for="items in refundData">
                            <td><input type="radio" name="optionsRadios"></td>
                            <td>{{items.balanceType}}</td>
                            <td>{{items.balance}}</td>
                            <td>{{items.balance1}}</td>
                            <td>{{items.balance2}}</td>
                            <td>{{items.balance3}}</td>
                            <td>{{items.balance4}}</td>
                            <td>{{items.balance5}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-md-4 col-sm-4 menu-style">
                    <div class="input-group">
                        <span class="input-group-addon">陪同票单价：</span>
                        <input type="text" class="form-control" placeholder="陪同票单价"/>
                    </div>
                </div>
                <div class="col-md-4 col-sm-4 menu-style">
                    <div class="input-group">
                        <span class="input-group-addon">购买数量：</span>
                        <input type="text" class="form-control" placeholder="购买数量"/>
                    </div>
                </div>
                <div class="col-md-4 col-sm-4 menu-style">
                    <div class="input-group">
                        <span class="input-group-addon">支付方式：</span>
                        <select  class="form-control">
                            <option value="0">现金</option>
                            <option value="1">代币</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-8 col-sm-8"></div>
                <div class="col-md-3 col-sm-3 menu-r-btn"><button type="button" class="btn">购买</button></div>
            </i-col>
            <i-col span="24" v-if="minuData.MenuShow3">
                <div class="col-md-3 col-sm-3"></div>
                <div class="col-md-6 col-sm-6 menu-style">
                    <div class="input-group col-md-12 col-sm-12 menu-style">
                        <span class="input-group-addon">门票票码：</span>
                        <input type="text" class="form-control" placeholder="门票票码"/>
                    </div>
                    <div class="input-group col-md-12 col-sm-12 menu-style">
                        <span class="input-group-addon">门票名称：</span>
                        <input type="text" class="form-control" placeholder="门票名称"/>
                    </div>
                    <div class="input-group col-md-12 col-sm-12 menu-style">
                        <span class="input-group-addon">入闸时间：</span>
                        <input type="text" class="form-control" placeholder="入闸时间"/>
                    </div>
                    <div class="input-group col-md-12 col-sm-12 menu-style">
                        <span class="input-group-addon">已缴费：</span>
                        <input type="text" class="form-control" placeholder="已缴费"/>
                    </div>
                    <div class="input-group col-md-12 col-sm-12 menu-style">
                        <span class="input-group-addon">入闸消费：</span>
                        <input type="text" class="form-control" placeholder="入闸消费"/>
                    </div>
                    <div class="input-group col-md-12 col-sm-12 menu-style">
                        <span class="input-group-addon">出闸缴费：</span>
                        <input type="text" class="form-control" placeholder="出闸缴费"/>
                    </div>
                    <div class="col-md-12 col-sm-12 menu-btn">
                        <button type="button" class="btn btn-primary">退费</button>
                        <button type="button" class="btn btn-primary">补交</button>
                    </div>
                </div>
                <div class="col-md-3 col-sm-3"></div>
            </i-col>
            <i-col span="24" v-if="minuData.MenuShow4">
                <div class="col-md-12 col-sm-12 menu-style">
                    <div class="input-group col-md-5 col-sm-5 menu-style">
                        <span class="input-group-addon">扣费项目：</span>
                        <i-select v-model="siteClearing.selectValue" style="width:200px">
                            <i-option v-for="item in siteClearing.optionList" :value="item.ProjectId" :key="item.ProjectId">{{ item.ProjectName }}</i-option>
                        </i-select>
                    </div>
                    <div class="col-md-4 col-sm-3 menu-style">
                        <radio-group v-model="siteClearing.radioValue">
                            <radio label="0">今天</radio>
                            <radio label="1">全部日期</radio>
                        </radio-group>
                    </div>
                    <div class="col-md-3 col-sm-2 menu-style width50">
                            <i-button @click="sluiceList('1')">刷新</i-button>
                        <!-- <button type="button" class="btn btn-info"></button> -->
                    </div>
                    <div class="col-md-12 col-sm-12 menu-style">
                        <i-table height="360" ref="selection" :columns="historyColumns" :data="historyData" @on-select-all="AllData" @on-selection-change="tableChecked"></i-table>
                        <div style="margin: 10px;overflow: hidden">
                            <div style="float: right;">
                                <Page :total="dataCount" :page-size="pageSize" show-total class="paging" @on-change="changepage"></Page>
                            </div>
                        </div>
                        <i-button @click="handleSelectAll(true)">全选</i-button>
                        <i-button @click="clearNotSluice">清场</i-button>
                    </div>
                </div>
            </i-col>
            <i-col span="24" v-if="minuData.MenuShow5">
                <div class="col-md-3 col-sm-4 menu-style">
                    <div class="input-group">
                        <span class="input-group-addon">订单号：</span>
                        <input type="text" class="form-control" placeholder="订单号" v-model="orderInquiry.orderNo"/>
                    </div>
                </div>
                <div class="col-md-3 col-sm-4 menu-style">
                        <div class="input-group">
                            <span class="input-group-addon">日期：</span>
                            <date-picker type="daterange" split-panels placeholder="Select date" format="yyyy-MM-dd" @on-change="timechoose" editable="true"></date-picker>
                        </div>
                </div>
                
                <div class="col-md-1 col-sm-1 menu-style">
                    <button type="button" class="btn btn-primary" @click="getOrders">查询</button>
                </div>
                <div class="col-md-12 col-sm-12 heightOver">
                    <div class="col-md-6 col-sm-6 menu-style">
                        <!-- <table id="table" class="table table-bordered">
                            <thead>
                                <tr>
                                    <th data-field="orderId">订单号</th>
                                    <th data-field="saleTime">销售日期</th>
                                    <th data-field="icCardId">会员</th>
                                    <th data-field="payCount">支付金额</th>
                                    <th data-field="orderStatusName">状态</th>
                                </tr>
                            </thead>
                        </table> -->
                        <i-table highlight-row ref="currentRowTable" :columns="orderInquiry.columns" :data="orderInquiry.listDataShow" @on-current-change="orderInquiryChoose"></i-table>
                        <div style="margin: 10px;overflow: hidden">
                            <div style="float: right;">
                                <Page :total="orderInquiry.dataCount" :page-size="orderInquiry.pageSize" show-total class="paging" @on-change="orderInquiryChangepage"></Page>
                            </div>
                        </div>
                        <table class="table table-bordered">
                            <thead style="background: #f5f5f5">
                            <tr>
                                <th>支付渠道</th>
                                <th>支付类别</th>
                                <th>支付</th>
                                <th>优惠</th>
                                <th>流水号</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-for="(item,index) in orderInquiry.orderPayData">
                                <td>{{item.balanceType}}</td>
                                <td>{{item.balanceIndex}}</td>
                                <td>{{item.payCount}}</td>
                                <td>{{item.balance2}}</td>
                                <td>{{item.balance3}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="col-md-6 col-sm-6 order-style">
                        <div class="input-group col-md-6 col-sm-6 order-style">
                            <span class="input-group-addon otherAddon">订单号：</span>
                            <input type="text" class="form-control" placeholder="订单号" v-model="orderInquiry.orderNo"/>
                        </div>
                        <div class="input-group col-md-6 col-sm-6 order-style">
                            <span class="input-group-addon otherAddon">销售日期：</span>
                            <input type="text" class="form-control" placeholder="销售日期" v-model="orderInquiry.theData"/>
                        </div>
                        <div class="input-group col-md-6 col-sm-6 order-style">
                            <span class="input-group-addon otherAddon">应付金额：</span>
                            <input type="text" class="form-control" placeholder="应付金额" v-model="orderInquiry.payable"/>
                        </div>
                        <div class="input-group col-md-6 col-sm-6 order-style">
                            <span class="input-group-addon otherAddon">优惠金额：</span>
                            <input type="text" class="form-control" placeholder="优惠金额" v-model="orderInquiry.preferential"/>
                        </div>
                        <div class="input-group col-md-6 col-sm-6 order-style">
                            <span class="input-group-addon otherAddon">实付金额：</span>
                            <input type="text" class="form-control" placeholder="实付金额" v-model="orderInquiry.realPay"/>
                        </div>
                        <div class="input-group col-md-6 col-sm-6 order-style">
                            <span class="input-group-addon otherAddon">收银员：</span>
                            <input type="text" class="form-control" placeholder="收银员" v-model="orderInquiry.cashier"/>
                        </div>
                        <div class="input-group col-md-12 col-sm-12 order-style">
                            <span class="input-group-addon otherAddon">备注：</span>
                            <textarea class="form-control" rows="2" v-model="orderInquiry.note"></textarea>
                        </div>
                        <div class="col-md-12 col-sm-12 order-style">
                            <table class="table table-bordered">
                                <thead style="background: #f5f5f5">
                                <tr>
                                    <th></th>
                                    <th>商品名称</th>
                                    <th>商品类别</th>
                                    <th>购买数量</th>
                                    <th>单价</th>
                                    <th>小计</th>
                                    <th>税率（%）</th>
                                    <th>税费</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr v-for="(item,index) in orderInquiry.goodsData">
                                    <td><input type="checkbox" :value="index" v-model="orderInquiry.exitChecked"></td>
                                    <td>{{item.foodName}}</td>
                                    <td>{{item.category}}</td>
                                    <td>{{item.saleCount}}</td>
                                    <td>{{item.singlePrice}}</td>
                                    <td>{{item.salePrice}}</td>
                                    <td>{{item.taxFee}}</td>
                                    <td>{{item.taxTotal}}</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>合计</td>
                                    <td></td>
                                    <td>{{orderInquiry.saleCount}}</td>
                                    <td></td>
                                    <td>{{orderInquiry.salePrice}}</td>
                                    <td></td>
                                    <td>{{orderInquiry.taxTotal}}</td>
                                </tr>
                                </tbody>
                            </table>
                            
                        </div>
                        <div class="col-md-12 col-sm-12 order-btn">
                            <div class="col-md-3 col-sm-3"></div>
                            <div class="col-md-3 col-sm-3">
                                <button type="button" class="btn btn-primary" :disabled="orderInquiry.disabled" @click="exitFood">退货</button>
                                <!-- :disabled="orderInquiry.disabled" -->
                            </div>
                            <div class="col-md-3 col-sm-3">
                                <button type="button" class="btn btn-primary" :disabled="orderInquiry.disabled">重打小票</button>
                            </div>
                            <div class="col-md-3 col-sm-3">
                                <button type="button" class="btn btn-primary" :disabled="orderInquiry.disabled">重打门票</button>
                            </div>
                        </div>
                    </div>
                </div>
            </i-col>
            <i-col span="24" v-if="minuData.MenuShow6">
                <row class="menu-style">
                    <i-col span="4">
                        <i-input v-model="buyBack.barCode" icon="search" placeholder="条码号" style="width: 100%" @on-click="getFoodChargeInfo('0')" @on-enter="getFoodChargeInfo('0')"></i-input>
                    </i-col>
                    <i-col span="4">
                        <i-input v-model="buyBack.goodName" icon="search" placeholder="商品名称" style="width: 100%" @on-click="getFoodChargeInfo('1')" @on-enter="getFoodChargeInfo('1')"></i-input>
                    </i-col>
                    <i-col span="16"></i-col>
                    <i-col span="4">
                            <!-- <i-input v-model="icCardId" placeholder="会员卡号">
                                <span slot="append">读卡</span>
                            </i-input> -->
                    </i-col>
                </row>
                <row class="menu-style">
                    <i-col span="15">
                        <i-table highlight-row ref="currentRowTable" :columns="buyBack.columns" :data="buyBack.listDataShow" @on-current-change="buyBackChoose"></i-table>
                        <div style="margin: 10px;overflow: hidden">
                            <div style="float: right;">
                                <Page :total="buyBack.dataCount" :page-size="buyBack.pageSize" show-total class="paging" @on-change="buyBackChangepage"></Page>
                            </div>
                        </div>
                    </i-col>
                    <i-col span="9">
                        <div class="col-md-12 col-sm-12 menu-style">
                            <div class="input-group">
                                <span class="input-group-addon">会员姓名：</span>
                                <input type="text" class="form-control" v-model="memberInfo.UserName" placeholder="会员姓名"/>
                            </div>
                        </div>
                        <div class="col-md-12 col-sm-12 menu-style">
                            <div class="input-group">
                                <span class="input-group-addon">会员级别：</span>
                                <input type="text" class="form-control" v-model="memberInput.LevelName" placeholder="会员级别"/>
                            </div>
                        </div>
                        <div class="col-md-12 col-sm-12 margin1">
                            <table class="table table-bordered">
                                <thead>
                                    <tr class="tableCenter">
                                        <th  colspan="1" rowspan="2" style="text-align: center;vertical-align: middle;">余额种类</th>
                                        <th colspan="3" style="text-align: center;">余额</th>
                                    </tr>
                                    <tr class="tableCenter">
                                        <th>正价</th>
                                        <th>赠送</th>
                                        <th>总计</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(item,index) in balanceData" :key="index">
                                        <td class="billingSty">{{item.BalanceName}}</td>
                                        <td class="billingColor">{{item.Balance}}</td>
                                        <td class="billingColor">{{item.BalanceFree}}</td>
                                        <td class="billingColor">{{item.TotalBalance}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </i-col>
                </row>
                <row class="menu-style">
                    <i-col span="15">
                        <div class="input-group col-md-4 col-sm-4">
                            <span class="input-group-addon">兑换种类：</span>
                            <i-select v-model="buyBack.useBalanceTypeId" style="width:200px">
                                <!-- <i-option v-for="item in buyBack.useBalance" :value="item.value" :key="item.value">{{ item.label }}</i-option> -->
                            </i-select>
                        </div>
                        <div class="input-group col-md-4 col-sm-4">
                            <span class="input-group-addon">兑换数量：</span>
                            <input type="text" class="form-control" placeholder="兑换数量" v-model="buyBack.goodCount"/>
                        </div>
                        <div class="input-group col-md-4 col-sm-4">
                            <span class="input-group-addon">兑换价值：</span>
                            <input type="text" class="form-control" placeholder="兑换价值" v-model="buyBack.goodValue" readonly/>
                        </div>
                    </i-col>
                    <!-- <i-col span="6"> &nbsp;
                    </i-col> -->
                    <i-col span="2">
                        <button type="button" class="btn btn-primary" @click="goodBuyBack">兑换</button>
                    </i-col>
                </row>
            </i-col>
            <i-col span="24" v-if="minuData.MenuShow7">
                    <div class="col-lg-4 col-md-4">
                        <div class="btn-group transferDatadropup col-lg-12 col-md-12">
                            <button type="button" class="btn btn-default">转出卡卡号：</button>
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu cardChoosesty">
                                <li @click="transferChoose('0')"><span class="iconfont icon-icqiaduqiaqi"></span><em>读卡器</em></li>
                                <li @click="transferChoose('1')"><span class="iconfont icon-3"></span><em>手动输入</em></li>
                            </ul>
                            <input  class="form-control" placeholder="请读卡" v-model="transferData.fromICCardId"/>
                            <button type="button" class="btn btn-default readCard" :disabled="loading" @click="fromICCardIdReadCard">{{transferData.dropChooseTxt1}}</button>
                        </div> 
                        <div class="input-group col-lg-12 col-md-12 tab-style">
                            <span class="input-group-addon addonWidth">转出卡密码：</span>
                            <input type="password" class="form-control" v-model="transferData.pwd"/>
                        </div>
                        <div class="btn-group transferDatadropup col-lg-12 col-md-12 tab-style">
                            <button type="button" class="btn btn-default">接收卡卡号：</button>
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"  aria-expanded="false">
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu cardChoosesty">
                                <li @click="transferChoose('2')"><span class="iconfont icon-icqiaduqiaqi"></span><em>读卡器</em></li>
                                <li @click="transferChoose('3')"><span class="iconfont icon-3"></span><em>手动输入</em></li>
                            </ul>
                            <input  class="form-control" placeholder="请读卡" v-model="transferData.toICCardId"/>
                            <button type="button" class="btn btn-default readCard" :disabled="loading" @click="toICCardIdReadCard">{{transferData.dropChooseTxt2}}</button>
                        </div> 
                        <div class="col-lg-8 col-md-8 tab-style">
                            
                        </div>
                        <div class="col-lg-4 col-md-4 tab-style">
                            <button type="button" class="btn btn-default width100" :disabled="loading" @click="memberTransfer">转换</button>
                        </div>
                    </div>
                    <div class="col-lg-8 col-md-8">
                        <div class="col-lg-12 col-md-12 tab-min">
                            <div class="col-lg-8 col-md-8">
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">手机号码：</span>
                                    <input   class="form-control" v-model="transferData.Mobile" maxlength="11" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">会员姓名：</span>
                                    <input   class="form-control" v-model="transferData.UserName" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">性别：</span>
                                    <input class="form-control" v-model="transferData.Gender" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">到期日期：</span>
                                    <input   class="form-control" v-model="transferData.EndDate" maxlength="11" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">押金：</span>
                                    <input   class="form-control" v-model="transferData.Deposit" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">级别：</span>
                                    <input   class="form-control" v-model="transferData.LevelName" readonly/>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-4">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr class="tableCenter">
                                            <th  colspan="1" rowspan="2"  style="text-align: center;vertical-align: middle;">余额种类</th>
                                            <th colspan="3" style="text-align: center;">余额</th>
                                        </tr>
                                        <tr class="tableCenter">
                                            <th style="text-align: center;">正价</th>
                                            <th style="text-align: center;">赠送</th>
                                            <th style="text-align: center;">总计</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(item,index) in transferData.balanceData" :key="index">
                                            <td class="billingSty">{{item.BalanceName}}</td>
                                            <td class="billingColor">{{item.Balance}}</td>
                                            <td class="billingColor">{{item.BalanceFree}}</td>
                                            <td class="billingColor">{{item.TotalBalance}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- <div class="mcImg col-lg-2 col-md-2">
                            <img :src="memberInfo.Avatar" alt="会员头像">
                        </div> -->
                        <div class="col-lg-12 col-md-12 tab-min">
                            <div class="col-lg-8 col-md-8">
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">手机号码：</span>
                                    <input   class="form-control" v-model="transferData.Mobile1" maxlength="11" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">会员姓名：</span>
                                    <input   class="form-control" v-model="transferData.UserName1" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">性别：</span>
                                    <input class="form-control" v-model="transferData.Gender1" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">到期日期：</span>
                                    <input   class="form-control" v-model="transferData.EndDate1" maxlength="11" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">押金：</span>
                                    <input   class="form-control" v-model="transferData.Deposit1" readonly/>
                                </div>
                                <div class="input-group col-lg-6 col-md-6 tab-text">
                                    <span class="input-group-addon addonWidth">级别：</span>
                                    <input   class="form-control" v-model="transferData.LevelName1" readonly/>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-4">
                                <table class="table table-bordered">
                                    <thead>
                                        <tr class="tableCenter">
                                            <th  colspan="1" rowspan="2"  style="text-align: center;vertical-align: middle;">余额种类</th>
                                            <th colspan="3" style="text-align: center;">余额</th>
                                        </tr>
                                        <tr class="tableCenter">
                                            <th style="text-align: center;">正价</th>
                                            <th style="text-align: center;">赠送</th>
                                            <th style="text-align: center;">总计</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="(item,index) in transferData.balanceData1" :key="index">
                                            <td class="billingSty">{{item.BalanceName}}</td>
                                            <td class="billingColor">{{item.Balance}}</td>
                                            <td class="billingColor">{{item.BalanceFree}}</td>
                                            <td class="billingColor">{{item.TotalBalance}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
            </i-col>
            <i-col span="24">

            </i-col>
            <i-col span="24">

            </i-col>
        </row>
    <div class="footer">
        <row type="flex" justify="center" align="middle" class="code-row-bg">
            <i-col span="5" class="dropdown-grounp">
                <dropdown trigger="click" placement="top" @on-click="dropChoose" class="dropdownSty">
                    <a href="javascript:void(0)">
                        {{inquireCard.dropChooseTxt1}}
                        <icon type="arrow-up-b"></icon>
                    </a>
                    <dropdown-menu slot="list">
                        <dropdown-item name="0"><span class="iconfont icon-icqiaduqiaqi"></span>读卡器</dropdown-item>
                        <dropdown-item name="1"><span class="iconfont icon-shenfenzhengrenzheng"></span>身份证</dropdown-item>
                        <dropdown-item name="2"><span class="iconfont icon-3"></span>手动输入</dropdown-item>
                    </dropdown-menu>
                </dropdown>
                <i-input v-model="inquireCard.keyInput" class="dropdownInput">
                    <span slot="append" @click="AllReadCard">{{inquireCard.dropChooseTxt2}}</span>
                </i-input>
            </i-col>
            <i-col span="19">
            </i-col>
        </row>
    </div>
</div>
<!-- Live the life you want;  -->
<script src="js/jquery-2.1.3.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<!-- 引入 Vue -->
<!-- <script src="js/vue.js"></script> -->
<script src="js/axios.min.js"></script>
<!-- 引入 bootstrap-table -->
<!-- <script type="text/javascript" src="js/bootstrap-datetimepicker.min.js" charset="UTF-8"></script> -->
<!-- <script type="text/javascript" src="js/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script> -->
<!-- <script src="js/bootstrap-table.js"></script> -->
<!-- <script src="js/bootstrap-table-zh-CN.js"></script> -->

<script>
    var sysId = 0; //调用方应用Id
    var versionNo= "0.01"; //版本号
    var machineName ="";
    var dogIdToken ="";
    var ws = new WebSocket("ws://127.0.0.1:12880");
    let testData = {
                "histories": [
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批已通过",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-24 18:11"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批已通过",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-24 18:11"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批已通过",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-24 10:04"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201",
                        "time": "2017-07-24 10:03"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201",
                        "time": "2017-07-24 10:02"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批已通过",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-24 10:02"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-24 10:01"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-24 09:56"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:23"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-21 14:23"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:23"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-21 14:23"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-21 14:23"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-21 14:21"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:21"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:20"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-21 14:20"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:14"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:13"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:11"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-21 14:10"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-20 18:09"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-20 18:08"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "  收入 > 999 && 支出 < 201 && 所有项目的总净收入 > 5000",
                        "time": "2017-07-20 18:08"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-20 18:07"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-20 18:05"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批已通过",
                        "shenpicomments": "wedfqw",
                        "time": "2017-07-20 15:50"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批已通过",
                        "shenpicomments": "wedfqw",
                        "time": "2017-07-20 15:20"
                    },
                    {
                        "username": "智能审批",
                        "shenpistatus": "审批被拒绝",
                        "shenpicomments": "自动审批通过",
                        "time": "2017-07-19 18:27"
                    }
                ]
            }
        
    var vm = new Vue({
        el: '#app',
        data:{
            loading:false,
            modalDelete:false,
            cardListModel:false,
            myModal:false,
            userToken:'',
            refundData:[{
                balanceType:"代币",
                balance:"2000",
                balance1:"1600",
                balance2:"400",
                balance3:"1600",
                balance4:"1000",
                balance5:"500"
            },{
                balanceType:"积分",
                balance:"200000",
                balance1:"200000",
                balance2:"0",
                balance3:"0",
                balance4:"0",
                balance5:"0"
            },{
                balanceType:"合计",
                balance:"",
                balance1:"",
                balance2:"",
                balance3:"",
                balance4:"1000",
                balance5:"500"
            }],       
            minuData:{
                MenuShow1:false,
                MenuShow2:false,
                MenuShow3:false,
                MenuShow4:false,
                MenuShow5:false,
                MenuShow6:false,
                MenuShow7:false,
                MenuShow8:false,
            },
            buyBack:{
                search:"",
                columns:[{title: '商品条码',key: 'barcode'},{title: '商品名称',key: 'goodName'},{title: '零售价',key: 'price'},{title: '回购代币数',key: 'allowCoin'},{title: '回购彩票数',key: 'allowLottery'},{title: '回购积分数',key: 'allowPoint'}],
                listData:[],
                listDataShow:[],
                pageSize:6,
                dataCount:0,
                goodValue:"",
                useBalance:[],
                useBalanceTypeId:"",
                goodCount:"",
                barCode:"",
                goodName:"",
                currentRow:[]
            },
            inquireCard:{
                show:false,
                mobileCode:"",
                keyInput:"",
                codeBtn:"获取验证码",
                dropChooseTxt1:"读卡器",
                dropChooseTxt2:"读卡",
                disabled:false
            },
            IDCardNo:"",
            memberInfo:{
				Avatar:"images/salesPic1.png",
				Birthday:"",
				Gender:"",
				Mobile:"",
				UserName: "",
                Note:""
            },
            memberInput:{
                mobileCode:"",
                disabled: false,
				CardAvatar: "",
                ICCardId: "",
                Deposit: "",
                EndDate: "",
                LevelName: ""
			},
            balanceData:[],
            childCardList:null,
            orderInquiry:{
                orderNo:"",
                dataTime:["",""],
                theData:"",
                payable:"",
                preferential:"",
                realPay:"",
                cashier:"",
                note:"",
                exitChecked:[],
                saleCount:"",
                salePrice:"",
                taxTotal:"",
                disabled:false,
                orderListData:[],
                orderPayData:[],
                goodsData:[],
                pageSize:6,
                dataCount:0,
                columns:[{title: '订单号',key: 'orderId'},{title: '销售日期',key: 'saleTime'},{title: '会员',key: 'icCardId'},{title: '支付金额',key: 'payCount'},{title: '状态',key: 'orderStatusName'}],
                listDataShow:[]
            },
            transferData:{
                fromICCardId:"",
                pwd:"",
                toICCardId:"",
                dropChooseTxt2:"读卡",
                dropChooseTxt1:"读卡",
                dropChooseIndex:"",
                Mobile:"",
                UserName:"",
                Gender:"",
                EndDate:"",
                Deposit:"",
                LevelName:"",
                balanceData:[],
                Mobile1:"",
                UserName1:"",
                Gender1:"",
                EndDate1:"",
                Deposit1:"",
                LevelName1:"",
                balanceData1:[],
            },
            siteClearing:{ 
                NotSluiceList:[],
                clearUpShow:false,
                radioValue:"0",
                selectValue:"",
                optionList:[],
                selection:[]
            },
            cardList:[],
            radioValue:"",
            icCardId:"",
            msg:"",
            ajaxHistoryData:[],
                // 初始化信息总条数
            dataCount:0,
            // 每页显示多少条
            pageSize:6,
            historyColumns: [{type: 'selection',width: 60,align: 'center'},{title: '项目名称',key: 'ProjectName'},{title: '扣费方式',key: 'Payment'},{title: '会员',key: 'MemberName'},{title: '进场时间',key: 'InTime'},{title: '入闸扣费',key: 'Expenses'},{title: '待缴场内消费',key: 'UnpaidAmount'},{title: '总费用',key: 'TotalAmount'}],
            historyData: []
        },
        mounted: function () {
            this.Initialize()
            this.WebSocketTest()
        },
        watch: {
            
        },
        methods: {
            Initialize:function () {
                var that =this;
                var userData = getStorage("userData");      	//获取userToken
                that.userToken = userData.userToken;
                console.log(that.userToken)
            },
            //			websocket配置函数
            WebSocketTest:function() {
                var that = this;
				if ("WebSocket" in window)
				{
					// 打开一个 websocket
					ws.onopen = function() {
						console.log("连接成功");
						var msgType0 =JSON.stringify({"msgType":"0","sObj":{"userToken": that.userToken}});
						function send(data)
						{
							console.log("Send:"+data);
							ws.send(data);
						}
						send(msgType0);
					};
					ws.onmessage = function (evt)
					{
						console.log("接收成功");
						var receivedMsg = JSON.parse(evt.data);
						console.log(receivedMsg);
						that.loading = false;
						if(receivedMsg.result_code == 1){
						    switch (receivedMsg.answerMsgType){
								case "0":                                              
								    break;
                                case "3":
                                    that.IDCardNo = receivedMsg.cardData.cardNo;
                                    that.getCardListByIDnumber(that.IDCardNo) 
                                break;
                                case "4":
                                    if(that.msgReadCard === "0"){
                                        that.outCoinData.icCardId = receivedMsg.dataObj.icCardId;
                                        that.getBalanceTypeByICCardId()
                                    }else if(that.msgReadCard === "1"){
                                        that.icCardId = receivedMsg.dataObj.icCardId;
                                        // that.getMenberCardInfo(that.icCardId,"")
                                        that.getMenberCardInfo("10004143","")
                                    }else if(that.msgReadCard === "2"){
                                        that.transferData.fromICCardId = receivedMsg.dataObj.icCardId;
                                        that.getMenberCardInfo(that.transferData.fromICCardId,"2")
                                    }else if(that.msgReadCard === "3"){
                                        that.transferData.toICCardId = receivedMsg.dataObj.icCardId;
                                        that.getMenberCardInfo(that.transferData.toICCardId,"3")
                                    }
                                    break;
                                case "5":
									that.msg = receivedMsg.answerMsg;
									that.myModal = true;
									// $('#myModal').modal('show');
                                    break;
								case "11":
								    if(that.msgEleven === "0"){
                                        that.dataObj =receivedMsg.dataObj;
                                        $('#checkoutModal').modal('show');
                                        that.inputCashFocus = true;
                                        that.registerCheckOut = true;
                                        that.shopCheckOut = false;
                                        that.cardCheckOut = false;
                                        that.registerFnc();
									}else if(that.msgEleven === "1"){
                                        that.dataObj =receivedMsg.dataObj;
                                        that.supplementCardFnc();
									}
                                    that.msgEleven = "";
                                	break;
                                default:
								    break;
							}
						}else if(receivedMsg.result_code == 0) {
							that.msg = receivedMsg.answerMsg;
                            that.myModal = true;
                    		// $('#myModal').modal('show');
						}
					};
					ws.onclose = function()
					{
						// 关闭 websocket
						// alert("连接已关闭...");
                        // window.location.href='login.html';
					};
				}
				else
				{
					// 浏览器不支持 WebSocket
					alert("您的浏览器不支持 WebSocket!");
				}
			},
//			按手机号查询会员信息
            getMember:function (type) {getMember
			    var that = this;
                switch (type){
                    case "0" :
                        var mobile = that.outCoinData.mobile;
                        var code = that.outCoinData.mobileCode;
                        // that.outCoinData.outCoinCard = "1";
                        break;
                    case "1" :
						var mobile = that.memberInfo.Mobile;
						var code = that.memberInput.mobileCode;
                        // that.outCoinData.outCoinCard = "";
                        break;
                    case "2" :
						var mobile = that.inquireCard.keyInput;
						var code = that.inquireCard.mobileCode;
                        that.outCoinData.outCoinCard = "";
                        break;
                    default:
                        break;
                }
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,mobile:mobile,code:code};
                console.log(obj);
			    if(mobile.length != 11 || code == ""){
                    that.msg = "请先确认手机号和验证码填写正确";
                    that.myModal = true;
                    // $('#myModal').modal('show');
                    setTimeout(function () {
                        that.myModal = false;
                    }, 1500);
				}else{
                    axios.post('/XCCloud/Member?action=getCardListByPhone', obj).then(function (res) {
                        console.log(res.data);
                        that.msgPrompt(res.data);
                        if (res.data.result_code === '1') {
                            that.cardList = res.data.result_data;
                            that.cardListModel = true;
                            // $('#cardList').modal('show');
                        }
                    }).catch(function (err) {
                        console.log(err);
                    });
				}
            },
//			身份证号查询会员信息
            getCardListByIDnumber:function (idCardNo) {
			    var that = this;
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,idCardNo:idCardNo};
                console.log(obj);
			    axios.post('/XCCloud/Member?action=getCardListByIDnumber', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        if(res.data.result_data.length == 0){
                            that.$Message.warning('没有查询到会员卡');
                        }else{
                            that.cardList = res.data.result_data;
                            that.cardListModel = true;
                        }
                    }
                }).catch(function (err) {
                    console.log(err);
                });
            },           
//			选择读卡方式
            dropChoose:function(name){
                console.log(name)
                var that = this;
				switch (name){
					case "0":
                        that.inquireCard.dropChooseTxt1 = "读卡器";
                        that.inquireCard.dropChooseTxt2 = "读卡";
					    break;
                    case "1":
                        that.inquireCard.dropChooseTxt1 = "身份证";
                        that.inquireCard.dropChooseTxt2 = "读取";
                        break;
                    case "2":
                        that.inquireCard.dropChooseTxt1 = "输入";
                        that.inquireCard.dropChooseTxt2 = "查询";
                        break;
				}
			},
//          菜单选择
            chooseMenu:function(MenuItem){
                var that = this;
                that.minuData ={MenuShow1:false,MenuShow2:false,MenuShow3:false,MenuShow4:false,MenuShow5:false,MenuShow6:false,MenuShow7:false,MenuShow8:false}
                switch (MenuItem){
					case "1":
                    window.location.href='thebar.html';
					    break;
                    case "2":
                        that.minuData.MenuShow1 =true;
                        break;
                    case "3":
                        that.minuData.MenuShow2 =true;
                        break;
                    case "4":
                        that.minuData.MenuShow3 =true;
                        break;
                    case "5":
                        that.minuData.MenuShow4 =true;
                        that.clearUp();
                        that.sluiceList("0")
                        break;
                    case "6":
                        that.minuData.MenuShow5 =true;
                        break;
                    case "7":
                        that.minuData.MenuShow6 =true;
                        break;
                    case "8":
                        that.minuData.MenuShow7 =true;
                        break;
                    default:
                        break;
				}
                console.log(MenuItem)
            },
            AllReadCard:function(){
                var that = this;
                that.loading = true;
				switch (that.inquireCard.dropChooseTxt2){
					case "读卡":
                        var msgType4 =JSON.stringify({"msgType":"4", "sObj": {"userToken": that.userToken}});
                        that.msgReadCard = "1";
                        console.log(that.inquireCard.dropChooseTxt2)
                        ws.send(msgType4);
					    break;
                    case "读取":
                        var msgType3 =JSON.stringify({"msgType":"3", "sObj": {"userToken": that.userToken}});
                        ws.send(msgType3);
                        break;
                    case "查询":
                        // if(){}
                        break;
				}
			},
//			选择会员卡
            radioCard:function(index){
                var that = this;
                console.log(index);
                that.radioValue = index;
                if(that.outCoinData.outCoinCard == "1"){
                    that.outCoinData.icCardId = that.cardList[that.radioValue].ICCardNo;
                    that.outCoinData.outCoinCard == ""
				}else {
                    that.icCardId = that.cardList[that.radioValue].ICCardNo;
                    that.cardId = that.cardList[that.radioValue].CardId;
				}
                that.cardListModel = false;
                that.radioValue = "";
                that.getMenberCardInfo(that.icCardId,"")
			},
//          按会员卡查询会员及卡信息
            getMenberCardInfo:function(icCardId,type){
                var that = this;
                that.loading = true;
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,icCardId:icCardId};
                console.log(obj);
                axios.post('/XCCloud/Member?action=getMenberCardInfoByICCardId', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    that.loading = false;
                    if (res.data.result_code === '1') {
                        if(type == "2"){
                            that.transferData.EndDate = res.data.result_data.EndDate;
                            that.transferData.Deposit = res.data.result_data.Deposit;
                            that.transferData.LevelName = res.data.result_data.LevelName;
                            that.transferData.balanceData = res.data.result_data.MemberBalances;
                            that.transferData.Mobile = res.data.result_data.MemberInfo.Mobile;
                            that.transferData.UserName = res.data.result_data.MemberInfo.UserName;
                            that.transferData.Gender = res.data.result_data.MemberInfo.Gender;
                        }else if(type == "3"){

                        }else{
                            that.memberInfo = res.data.result_data.MemberInfo;
                            that.balanceData = res.data.result_data.MemberBalances;
                            that.memberInput.LockList = res.data.result_data.LockList;
                            that.memberInput.ICCardId = res.data.result_data.ICCardId;
                            that.memberInput.EndDate = res.data.result_data.EndDate;
                            that.memberInput.Deposit = res.data.result_data.Deposit+"元";
                            that.memberInput.LevelName = res.data.result_data.LevelName;
                            that.memberInput.CardAvatar = res.data.result_data.CardAvatar;
                            var TitleCardList =[];
                            var childCardList =res.data.result_data.ChildCardList;
                            for(var i = 0;i<childCardList.length;i++){
                                TitleCardList.push({
                                    CardShape: childCardList[i].CardShape,
                                    ChildICCardId: childCardList[i].ChildICCardId,
                                    Deposit: childCardList[i].Deposit,
                                    Avatar: childCardList[i].ChildCardMemberInfo.Avatar,
                                    Birthday: childCardList[i].ChildCardMemberInfo.Birthday,
                                    Gender: childCardList[i].ChildCardMemberInfo.Gender,
                                    UserName: childCardList[i].ChildCardMemberInfo.UserName,
                                    titleIndex:"childCard"+(i+1),
                                    titleHref:"#childCard"+(i+1),
                                    indexTxt:"副卡"+(i+1)
                                })
                            }
                            that.childCardList= TitleCardList;
                        }
                        
                    }
                }).catch(function (err) {
                    console.log(err);
                    that.loading = false;
                });
			},
//          转出卡IC卡号事件
            fromICCardIdReadCard:function(){
                var that = this;
                that.loading = true;
                if(that.transferData.dropChooseIndex == "0"){
                    var msgType4 =JSON.stringify({"msgType":"4", "sObj": {"userToken": that.userToken}});
                    that.msgReadCard = "2";
                    ws.send(msgType4);
                }else if(that.transferData.dropChooseIndex == "1"){
                    console.log(that.transferData.fromICCardId)
                    that.getMenberCardInfo(that.transferData.fromICCardId,"")
                }
			},
//          接收卡IC卡号事件
            toICCardIdReadCard:function(){
                var that = this;
                if(that.transferData.dropChooseIndex == "2"){
                    var msgType4 =JSON.stringify({"msgType":"4", "sObj": {"userToken": that.userToken}});
                    that.msgReadCard = "3";
                    ws.send(msgType4);
                }else if(that.transferData.dropChooseIndex == "3"){
                    console.log(that.transferData.toICCardId)
                    that.getMenberCardInfo(that.transferData.toICCardId,"1")
                }
			},
//          会员过户卡选择
            transferChoose:function(index){
                var that = this;
                that.transferData.dropChooseIndex = index;
				switch (index){
					case "0":
                        that.transferData.dropChooseTxt1 = "读卡";
					    break;
                    case "1":
                        that.transferData.dropChooseTxt1 = "查询";
                        break;
                    case "2":
                        that.transferData.dropChooseTxt2 = "读卡";
                        break;
                    case "3":
                        that.transferData.dropChooseTxt2 = "查询";
                        break;
                    default:
                        break;
				}
            },
//          会员过户
            memberTransfer:function(){
                var that = this;
                if(that.transferData.toICCardId == "" || that.transferData.fromICCardId == "" || that.transferData.pwd == ""){
                    that.msg = "输入不能为空！";
                    that.myModal = true;
                    // $('#myModal').modal('show');
                    setTimeout(function () {
                        that.myModal = false;
                        // $('#myModal').modal('hide');
                    }, 1500);
                }else{
                    that.loading = true;
                    var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,fromICCardId:that.transferData.fromICCardId,pwd:that.transferData.pwd,toICCardId:that.transferData.toICCardId};
                    console.log(obj);
                    axios.post('/XCCloud/Member?action=memberTransfer', obj).then(function (res) {
                        console.log(res.data);
                        that.loading = false;
                        that.msgPrompt(res.data);
                        if (res.data.result_code === '1') {
                            that.msg = "转卡成功！";
                            that.myModal = true;
                            // $('#myModal').modal('show');
                            setTimeout(function () {
                                that.myModal = false;
                                // $('#myModal').modal('hide');
                            }, 1500);
                        }
                    }).catch(function (err) {
                        console.log(err);
                    });
                }
            },
//          订单查询接口
            getOrders:function(){
                var that = this;
                console.log(that.orderInquiry.dataTime)
                that.orderInquiry = {
                    orderNo:that.orderInquiry.orderNo,
                    dataTime:that.orderInquiry.dataTime,
                    theData:"",
                    payable:"",
                    preferential:"",
                    realPay:"",
                    cashier:"",
                    note:"",
                    exitChecked:[],
                    saleCount:"",
                    salePrice:"",
                    taxTotal:"",
                    disabled:false,
                    orderListData:[],
                    orderPayData:[],
                    goodsData:[]
                };
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,orderId:that.orderInquiry.orderNo,icCardId:that.icCardId,startDate:that.orderInquiry.dataTime[0],endDate:that.orderInquiry.dataTime[1]};
                console.log(obj);
                axios.post('/xccloud/order?action=getOrders', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        that.orderInquiry.orderListData=res.data.result_data;
                        that.orderInquiry.dataCount = res.data.result_data.length;
                        if(that.orderInquiry.dataCount < that.orderInquiry.pageSize){
                            that.orderInquiry.listDataShow = that.orderInquiry.listData;
                        }else{
                            that.orderInquiry.listDataShow = that.orderInquiry.listData.slice(0,that.orderInquiry.pageSize);
                        }
                    }
                }).catch(function (err) {
                    console.log(err);
                });
            },
//          查询订单详情
            orderInquiryChoose:function(currentRow){
                console.log(currentRow)
                var that = this;
                that.orderInquiry = {
                    orderNo:"",
                    stratTime:"",
                    endTime:"",
                    theData:"",
                    payable:"",
                    preferential:"",
                    realPay:"",
                    cashier:"",
                    note:"",
                    exitChecked:[],
                    saleCount:"",
                    salePrice:"",
                    taxTotal:"",
                    disabled:false,
                    orderListData:that.orderInquiry.orderListData,
                    orderPayData:[],
                    goodsData:[]
                };
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,flwOrderId:currentRow.orderId};
                if(currentRow.orderStatusName != "已支付"){
                    that.orderInquiry.disabled = true;
                }else{
                    that.orderInquiry.disabled = false; 
                }
                console.log(obj);
                axios.post('/xccloud/order?action=getOrderDetailContain', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        that.orderInquiry.orderPayData=res.data.result_data.orderPay;
                        that.orderInquiry.goodsData=res.data.result_data.orderDetail;
                        that.orderInquiry.orderNo=res.data.result_data.orderMain.orderId;
                        that.orderInquiry.theData=res.data.result_data.orderMain.saleTime;
                        that.orderInquiry.payable=res.data.result_data.orderMain.payCount;
                        that.orderInquiry.preferential=res.data.result_data.orderMain.freePay;
                        that.orderInquiry.realPay=res.data.result_data.orderMain.realPay;
                        that.orderInquiry.cashier=res.data.result_data.orderMain.realName;
                        that.orderInquiry.note=res.data.result_data.orderMain.note;
                        var salePrice = 0;
                        var saleCount = 0;
                        var taxTotal = 0;
                        for(var i = 0; i<that.orderInquiry.goodsData.length; i++){
                            salePrice =salePrice+that.orderInquiry.goodsData[i].salePrice*1                            
                            saleCount =saleCount+that.orderInquiry.goodsData[i].saleCount*1
                            taxTotal =taxTotal+that.orderInquiry.goodsData[i].taxTotal*1
                        }
                        that.orderInquiry.saleCount = saleCount
                        that.orderInquiry.salePrice = salePrice
                        that.orderInquiry.taxTotal = taxTotal
                    }
                }).catch(function (err) {
                    console.log(err);
                });
            },
//          回购分页按钮
            orderInquiryChangepage:function(index){
                var that = this;
                var _start = ( index - 1 ) * that.orderInquiry.pageSize;
                var _end = index * that.orderInquiry.pageSize;
                that.orderInquiry.listDataShow = that.orderInquiry.listData.slice(_start,_end);
            },
//          获取兑换商品信息
            getFoodChargeInfo:function(type){
                var that = this;
                if(type == "0"){
                    var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,barCode:that.buyBack.barCode,goodName:""};
                }else if(type == "1"){
                    var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,barCode:"",goodName:that.buyBack.goodName};
                }
                console.log(obj);
                axios.post('/XCCloud/Foods?action=getFoodChargeInfo', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        that.buyBack.dataCount = res.data.result_data.length;
                        if(that.buyBack.dataCount == "0"){
                            that.$Message.warning('暂无数据！');
                        }
                        that.buyBack.listData = res.data.result_data;
                        if(that.buyBack.dataCount < that.buyBack.pageSize){
                            that.buyBack.listDataShow = that.buyBack.listData;
                        }else{
                            that.buyBack.listDataShow = that.buyBack.listData.slice(0,that.buyBack.pageSize);
                        }
                        
                    }
                }).catch(function (err) {
                    console.log(err);
                });
            },
//          商品回购信息
            goodBuyBack:function(){
                var that = this;
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,icCardId:that.ICCardId,goodId:this.buyBack.currentRow.id,goodCount:this.buyBack.goodCount,useBalanceTypeId:this.buyBack.useBalanceTypeId,note:""};
                console.log(obj);
                axios.post('/XCCloud/Foods?action=goodBuyBack', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        
                    }
                }).catch(function (err) {
                    console.log(err);
                });
            },
//          获取选中的表格数据
            buyBackChoose:function(currentRow){
                console.log(currentRow)
                this.buyBack.currentRow = currentRow
            },
//          回购分页按钮
            buyBackChangepage:function(index){
                var that = this;
                var _start = ( index - 1 ) * that.buyBack.pageSize;
                var _end = index * that.buyBack.pageSize;
                that.buyBack.listDataShow = that.buyBack.listData.slice(_start,_end);
            },
//          退货接口
            exitFood:function(){
                var that = this;
                var exitFoodJson = []
                console.log(that.orderInquiry.exitChecked);
                for(var i = 0;i<that.orderInquiry.exitChecked.length;i++){   
                    exitFoodJson.push({
                        foodId: that.orderInquiry.goodsData[that.orderInquiry.exitChecked[i]].foodId,
                        category: that.orderInquiry.goodsData[that.orderInquiry.exitChecked[i]].category,
                        saleCount: that.orderInquiry.goodsData[that.orderInquiry.exitChecked[i]].saleCount,
                    })   
				}
                exitFoodJson = JSON.stringify(exitFoodJson); //转化为JSON字符串
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,flwOrderId:that.orderInquiry.orderNo,note:that.orderInquiry.note,authorId:"0",exitFoodJson:exitFoodJson};
                console.log(obj);
                axios.post('/XCCloud/foods?action=exitFood', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        alert(111)
                    }
                }).catch(function (err) {
                    console.log(err);
                });
            },
//          清场点击
            clearUp:function(){
                var that = this;
                
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken};
                console.log(obj);
                axios.post('/XCCloud/ProjectTicket?action=getProjectList', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        that.siteClearing.optionList = res.data.result_data;
                    }
                }).catch(function (err) {
                    console.log(err);
                });
                
            },
//          时间选择
            timechoose:function(e){
                console.log(e);
                if(e[0] == ""){
                    this.orderInquiry.dataTime = ["",""];
                }else{
                    this.orderInquiry.dataTime = e;
                }
                console.log(this.orderInquiry.dataTime)
            },
//          刷新按钮
            sluiceList:function(type){
                var that = this;
                if(type == "0"){
                    var projectId = "";
                }else{
                    var projectId = that.siteClearing.selectValue
                }
                var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,projectId:projectId,dateType:that.siteClearing.radioValue};
                console.log(obj);
                axios.post('/XCCloud/ProjectTicket?action=getProjectNotSluiceList', obj).then(function (res) {
                    console.log(res.data);
                    that.msgPrompt(res.data);
                    if (res.data.result_code === '1') {
                        that.ajaxHistoryData = res.data.result_data;
                        that.dataCount = res.data.result_data.length;
                        // 初始化显示，小于每页显示条数，全显，大于每页显示条数，取前每页条数显示
                        if(that.dataCount < that.pageSize){
                            that.historyData = that.ajaxHistoryData;
                        }else{
                            that.historyData = that.ajaxHistoryData.slice(0,that.pageSize);
                        }
                    }
                }).catch(function (err) {
                    console.log(err);
                });
            },
//          页码切换
            changepage(index){
                var _start = ( index - 1 ) * this.pageSize;
                var _end = index * this.pageSize;
                this.historyData = this.ajaxHistoryData.slice(_start,_end);
            },
//          全选
            handleSelectAll (status) {
                this.$refs.selection.selectAll(status);
            },
//          表格改变返回数据        
            tableChecked:function(selection){
                this.siteClearing.selection = selection;
                console.log(selection)
            },
//          全选返回数据
            AllData(selection){
                this.siteClearing.selection = selection;
                console.log(selection)
            },
//          手动清除未出闸游乐信息
            clearNotSluice:function(){
                var that = this;
                console.log(that.siteClearing.selection)
                if(that.siteClearing.selection.length == 0){
                    this.$Message.warning('请先选择清场目标');
                }else{
                    that.modalDelete = true;
                }
            },
            okClearUp:function(){
                var that = this;
                    var projectTicketId = that.siteClearing.selection[0].TicketUseId+"";
                    for(var i = 1;i<that.siteClearing.selection.length;i++){
                        projectTicketId =projectTicketId+","+that.siteClearing.selection[i].TicketUseId
                    }
                    console.log(projectTicketId)
                    var obj={sysId: sysId,versionNo: versionNo,userToken:that.userToken,projectTicketId:projectTicketId};
                    console.log(obj);
                    axios.post('/XCCloud/ProjectTicket?action=clearNotSluiceTicket', obj).then(function (res) {
                        console.log(res.data);
                        that.msgPrompt(res.data);
                        if (res.data.result_code === '1') {
                            that.msg = "清理成功！";
                            that.myModal = true;
                            that.sluiceList("1")
                        }
                    }).catch(function (err) {
                        console.log(err);
                    });
                
            },

//			通用消息提示
            msgPrompt:function (res) {
                var that = this;
                if(res.return_code == 0){
                    that.msg = res.return_msg;
                    that.myModal = true;
                    if(that.msg == "用户令牌已失效, 请重新登录"){
                        setTimeout(function () {
                            window.location.href='login.html';
                        }, 3000);
                    }
                   
                }else if(res.result_code == 0){
                    that.msg = res.result_msg;
                    that.myModal = true;
                    if(that.msg == "用户令牌已失效, 请重新登录"){
                        setTimeout(function () {
                            window.location.href='login.html';
                        }, 3000);
                    }
                }
            }
        },
        created(){
        }
    });

    //存储session
    function setStorage(key,value) {
        if(window.localStorage){
            value = JSON.stringify(value); //转化为JSON字符串
            var storage=window.localStorage;
            storage.setItem(key,value);
        }
    }
    //删除session
    function removeStorage(key) {
        if(window.localStorage){
            var storage=window.localStorage;
            storage.removeItem(key);
        }
    }
    //获取session
    function getStorage(key) {
        if(window.localStorage){
            value = JSON.parse(localStorage.getItem(key));
            return value;
        }
    }
    
</script>
</body>
</html>